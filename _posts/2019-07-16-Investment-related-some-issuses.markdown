---
layout: post
title: Investment related some issuse from my work
excerpt: summery of my work as investment strategy modeling at last two years 我的这两年的投资策略研究工作中遇到问题的总结
categories:
    - tech
tags:
    - languages
layout: post
---
<ul class="org-ul">
<li>我的这两年的投资策略研究工作中遇到问题的总结
</li>
</ul>

<p>
我最近两年做投资策略相关的工作，在不断尝试各种策略的同时，思考了一些相关的问题。我觉得有必要总结一些，或许对感兴趣的人有所帮助和启发。
</p>

<p>
首先讲一些数学上的基本概念和结论，有证明和推导过程。这些结论普遍适用，虽然无法直接用来获利，对于分析策略模型是有帮助的。
然后，提出三种数据取样方法和一个策略模型。
数据取样方法的规则比较明确，可以用程序在几秒钟之内处理完毕十年的数据，如果程序实现良好的话。满足取样规则的数据，我称为结构，可以作为构建策略的基本元素。
我现在用上面方法构建的策略模型，经过沪深300指数(000300.ICSI)十年数据回测，收益为10倍左右。这个模型的推广适用性，是否过优化等问题，仍然有待验证。我对此比较乐观。
</p>


<p>
++  一个简单的硬币游戏
</p>

<p>
<del>+</del> 规则和简单分析
</p>

<p>
首先，考虑玩一个简单的游戏。
</p>

<p>
抛一个均质硬币，猜正反面。假设两面概率完全相同(p1=p2=0.5)，竖立无效(如果出现就重抛，直到有效)。 每次下注 f 元， 如果猜对，
赌注f 返还， 另外赢 2f 元。如果猜错，赌注f 全部输掉。初始资金100元，最多玩100次。 f 每次取多少， 是最佳策略？
</p>

<p>
以一搏二，显然这是一个对我方有利的游戏。这里有利定义为收益的期望， 即单次游戏中，各种可能收益的加权平均值为正。
收益期望计算如下
</p>

<p>
E = 0.5*2*f+0.5*(-1)*f = 0.5*f &gt; 0
</p>

<p>
显然，每次下注f 越大时，单次的收益期望越大，累计期望同样也越大。另外一方面，每次下全部赌注，最终剩余资金不为零的概率为 （1/2^100），
换句话说，除非太阳打西边出来，否则最终收益一定是零。
同时，可以得到最终收益期望为(3^100/2^100)=1.5^100=4.066*10^17, 的确是一个很大的数字。
</p>

<p>
这里主要说明的是，计算收益的期望有助于我们判断游戏是否对我有利，但是不应该用来计算我们游戏时投注的比例(这里指连续游戏)。
<del>+</del> 体验游戏及数据实验
</p>

<p>
++ 凯利(kelly)公式及推导
</p>

<p>
<del>+</del> 双倍下注或则过度下注是谎言
</p>

<p>
<del>+</del> 连续价格假设
</p>

<p>
实际证券行情，尤其是指数行情，往往是连续的(相邻k线有重叠)，跳空比较少。是否可以利用这个特点，实现一个稳定盈利的模型呢？
</p>

<p>
++ 无预测模型， 保护线方法可否无往而不利
</p>

<p>
假设行情连续波动，我预测行情将从 a 到 a + 10， 实时盯盘，机器交易，几乎可以做到行情一旦上穿价格a， 就立马开仓，一旦跌穿价格a，就平仓。
这条线a， 我们就叫做保护线。假设价格是连续的，在操作误差范围内，我们应该总是能成功在a 这个价格附近成交。
如此，不考虑多次交易手续费，以及操作价格与理想价格的误差的情况小，帐号不可能再有损失，即使当初的预测完全错误。
使用这种策略，除非预测完全错误，否则帐号一定是盈利的。实际上，无信息的情况下，预测完全错误和预测完全错误一样难。
对于预测准确率本来就较高的策略，嵌套使用保护线高频策略，可以实现收益加倍。那么，保护线方法，真的能无往不利吗？
</p>

<p>
<del>+</del> 计算手续费率对模型的影响
</p>

<p>
例如千分之二点五的手续费， 完全相同的操作， 和无手续费相比，多少次以后，后者资产是前者两倍？
</p>

<p>
(推导过程待续)
</p>

<p>
结论： 0.7 * （1000 / 2.5）， 即约 280 次操作以后，与无手续费相比，资产减半。不适合做高频交易。
假设万分之一的手续费，这个值是7000， 完全可以做高频短期交易。
</p>

<p>
手续费的差别，对策略交易频率的影响是决定性的。保护线方法在手续费千分之一时，勉强是可行的，但是现在股指期货日内交易手续费高达千分之三，
使用这种方法的获利，只有不到多交手续费的一半。
</p>

<p>
实际上，如果交易所取消日内交易手续费惩罚，随着使用这种策略的人增多，会导致价格波动更剧烈，跳空增多，导致保护线策略的前提不复存在。
这个结果与市场零和的大前提是一致的，不可能所有人都盈利，所以能够让所有人都盈利的策略，会导致策略前提不满足，从而导致自身的失效。
</p>

<p>
<del>+</del> 香农提出的无预测套利模型
</p>

<p>
简单来说，满足随机波动的行情，是否跳空无所谓，高价时按一个公式给出的比例卖出，低价时，按照公式给定比例买进，类似于加倍买进。长期来看，经历了足够长时间的波动后，收益期望是正的，
初始开仓价格和当前价格短期来看会有影响，但长期来看，影响很小。
和保护线模型一样，手续费较高时失效。如果没有手续费的话，当足够多的人使用该策略时，
会导致价格无波动。 价格无波动也可以是连续下跌，此时根据香农提出的公式，需要不断加仓买入。
由于单个帐户的资金是有限的，当行情跌倒一定程度时，总会有些账户无法继续跟进，从而无法使用这个模型盈利。(或许说，真正的行情底部，是大多数人无钱再抄底的时候)
</p>

<p>
(或许这两大类模型的拮抗作用，是解释P 结构出现的原因。这部分分析不太严谨，后续再补充)
</p>

<p>
++ 收益由预测决定
</p>

<p>
++ 行情数据取样方法 BSP
</p>

<p>
<del>+</del> B， k线的单边行情划分
</p>

<p>
<del>+</del> S， 允许波动较大的，B 的再取样，划分更大时间范围的大致单边行情
</p>

<p>
<del>+</del> P， 一种标注大多数账户成本线区间的结构
</p>

<p>
<del>+</del> 延迟，正确性和时效性不可兼得
</p>

<p>
++ 一种盈利模型
</p>
<ol class="org-ol">
<li>预测的根本是找到一种规律，这种规律最好不随着市场，时间的变化而变化。
</li>
<li>一个用于实际操作的模型，必须要有一个作为用于兜底的底线止损策略，处理所有模型没有预料到，无法理解的情况。现在我们用的是简单百分比止损
</li>
<li>平仓要有行情模式的依据，这种依据要有回测的验证。根据我的数据实验，不能简单的设定盈利百分之多少就平仓。
</li>
<li>盈利可是适当使用贪婪模式，在遇到理想的平仓模式前，如果识别到相反的模式，最好能在强制止损前以小盈利卖出。
</li>
<li>对于超大行情，设定一个阈值后，粗放操作。
</li>
</ol>

<p>
<del>+</del> 尝试解释模型背后的规律， 止损的集体共识与止损线的集中导致强势的下跌。
</p>
